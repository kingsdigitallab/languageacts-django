{% extends "cms/base.html" %}
{% load wagtailcore_tags %}

{% block meta_title %}Search Results{% endblock %}

{# Not a fan of this, but it's the least hacky way to feed the title back. #}
{% block title %}
<header class="section-header">
  <h1>Search Results for: {{ request.GET.q }}</h1>
</header>
{% endblock %}

{% block main %}

{% if search_results %}
<ol class="search-results">
  {% for result in search_results %}
    <li>
      <h4>
        <a href="{% pageurl result.specific %}">{{ result.specific }}</a>
      </h4>
      {% if result.specific.search_description %}
      <p>{{ result.specific.search_description|safe }}</p>
      {% endif %}
      
      {% if result.specific.strands.all or result.specific.tags.all %}
      <div class="tags plain">
        {% if result.specific.strands.all %}
        {% for strand in result.specific.strands.all %}
        <span class="label secondary"><a href="{% pageurl strand %}" class="strand">{{ strand.title }}</a></span>
        {% endfor %}
        {% endif %}

        {% if result.specific.tags.all %}
        {% for tag in result.specific.tags.all %}
        <span class="label"><a href="/search/?q={{ tag.name|urlencode }}">{{ tag.name }}</a></span>
        {% endfor %}
        {% endif %}
      </div>
      {% endif %}
    </li>
  {% endfor %}
</ol>
{% else %}
<p>No results found.</p>
{% endif %}

{% endblock %}
